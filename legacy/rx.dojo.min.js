/**
* Copyright 2011 Microsoft Corporation
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/

(function(d){var d=d.Rx,e=d.Observable,c=d.AsyncSubject,f=e.create;e.fromDojoEvent=function(a,b,g,c){return f(function(d){var e=dojo.connect(a,b,g,function(b){d.onNext(b)},c);return function(){dojo.disconnect(e)}})};dojo.xhrGetAsObservable=function(a){var b=new c;a.load=function(a){b.onNext(a);b.onCompleted()};a.error=function(a){b.onError(a)};dojo.xhrGet(a);return b};dojo.xhrPostAsObservable=function(a){var b=new c;a.load=function(a){b.onNext(a);b.onCompleted()};a.error=function(a){b.onError(a)};
dojo.xhrPost(a);return b};dojo.xhrPutAsObservable=function(a){subject=new c;a.load=function(a){subject.onNext(a);subject.onCompleted()};a.error=function(a){subject.onError(a)};dojo.xhrPut(a);return subject};dojo.xhrDeleteAsObservable=function(a){var b=new asyncSubject;a.load=function(a){b.onNext(a);b.onCompleted()};a.error=function(a){b.onError(a)};dojo.xhrDelete(a);return b};dojo.Deferred.prototype.asObservable=function(){var a=new ayncSubject;this.then(function(b){a.onNext(b);a.onCompleted()},function(b){a.onError(b)});
return a};c.prototype.asDeferred=function(){var a=new dojo.Deferred;this.subscribe(function(b){a.callback(b)},function(b){a.errback(b)});return a};dojo.io&&dojo.io.script&&(dojo.io.script.getAsObservable=function(a){var b=new c;a.load=function(a){b.onNext(a);b.onCompleted()};a.error=function(a){b.onError(a)};dojo.io.script.get(a);return b})})(this);